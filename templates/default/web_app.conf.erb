# Generated by Chef
<% if @params[:ssl_enabled] %>
<VirtualHost *:<%= @params[:ssl_server_port] || '443' %> >
SSLEngine on
SSLCertificateFile <%= @params[:ssl_certificate_file] %>
SSLCertificateKeyFile <%= @params[:ssl_certificate_key_file] %>
<% if @params[:ssl_certificate_chain_file] %>
SSLCertificateChainFile <%= @params[:ssl_certificate_chain_file] %>
<% end %>
<IfModule mod_fastcgi.c>
DirectoryIndex index.php
AddHandler php5-fcgi .php
Action php5-fcgi /php5-fcgi-ssl
Alias /php5-fcgi-ssl /usr/lib/cgi-bin/php5-fcgi-<%= @params[:name] %>-ssl
FastCgiExternalServer /usr/lib/cgi-bin/php5-fcgi-<%= @params[:name] %>-ssl -socket fpm-<%= @params[:name] %>.sock -pass-header Authorization -idle-timeout <%= @timeout || 6000 %>
</IfModule>
<%= render "web_app_common.erb", :local => false %>
</VirtualHost>
<% end %>
<VirtualHost *:<%= @params[:server_port] || '80' %> >
<% if @params[:force_https] %>
Redirect permanent / https://<%= @params[:server_name] %>/
<% else %>
<%= render "web_app_common.erb", :local => false %>
<IfModule mod_fastcgi.c>
DirectoryIndex index.php
AddHandler php5-fcgi .php
Action php5-fcgi /php5-fcgi
Alias /php5-fcgi /usr/lib/cgi-bin/php5-fcgi-<%= @params[:name] %>
FastCgiExternalServer /usr/lib/cgi-bin/php5-fcgi-<%= @params[:name] %> -socket fpm-<%= @params[:name] %>.sock -pass-header Authorization -idle-timeout <%= @timeout || 60000 %>
</IfModule>
<% end %>
</VirtualHost>


